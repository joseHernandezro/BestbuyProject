<!DOCTYPE html>
<html>

<head>
  <style>
    /* HERE WE DEFINE THE STYLE OF THE MAP INFOWINDOW*/
     .gm-style-iw.gm-style-iw-c{
        padding:0px;
    }
    /*HERE WE DEFINE THE STYLE OF THE CONTENT INSIDE
    INFOWINDOWS*/
    .gm-style-iw-d {
      overflow: hidden !important;
      border: 2px solid powderblue;
      width: auto;
      height: auto;
      color: rgb(0, 0, 0);
      font-family: verdana;
      font-size: 20px;
      background: linear-gradient(#deded7, #c9c86b);
      justify-content: center;
      align-items: center;
    }
    
    /* #LocationContent {
      border: 2px solid powderblue;
      width: 30vh;
      height: 30vh;
      color: rgb(0, 0, 0);
      font-family: verdana;
      font-size: 90%;
      background: linear-gradient(#deded7, #c9c86b);
    } */

    #firstHeading {
      display: flex;
      width: 92%;
      height: 20%;
      padding: 4%;
      justify-content: center;
      align-items: center;
      
    }

    #contentDetails {
      padding-left: 10px;
      padding-right: 10px;
    }

    button {
      background-color: #1b6be4;
      color: white;
      padding: 0px 40px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 15px;
    }

    .buttonContainer {
      text-align: center;
    }
  </style>
</head>

<body>
  <div id="googleMap" style="width:100%;height:98vh;"></div>
  <script>
    var activeInfoWindow;
    function myMap() {
      var mapProp = {
        center: new google.maps.LatLng(32.771759, -117.132016),
        zoom: 12,
      };
      this.map = new google.maps.Map(document.getElementById("googleMap"), mapProp);
      locatePins('[{"country":"US","storeType":"Big Box","hours":"Sun: 11-7; Mon: 10-8; Tue: 10-8; Wed: 10-8; Thurs: 10-8; Fri: 10-8; Sat: 10-8; Sun: 11-7; Mon: 10-8; Tue: 10-8; Wed: 10-8; Thurs: 10-8; Fri: 10-8; Sat: 10-8; Sun: 11-7; Mon: 10-8; Tue: 10-8; Wed: 10-8; Thurs: 10-8; Fri: 10-8; Sat: 10-8; Sun: 11-7; Mon: 10-8; Tue: 10-8; Wed: 10-8; Thurs: 10-8; Fri: 10-8; Sat: 10-8","address":"5151 Mission Center Rd","lng":-117.15275,"address2":"","city":"San Diego","postalCode":"92108","locationType":"Store","services":[{"service":"Amazon Alexa Experience"},{"service":"Apple Authorized Service Provider"},{"service":"Apple Shop"},{"service":"Camera Experience Shop"},{"service":"Geek Squad Services"},{"service":"Google Home Experience"},{"service":"Car and GPS Install Services"},{"service":"LG Experience"},{"service":"Magnolia Design Center"},{"service":"Microsoft Windows Store"},{"service":"Samsung Entertainment Experience"},{"service":"Samsung Experience"},{"service":"Sony Experience"},{"service":"Samsung Open House"},{"service":"Trade-In"}],"storeId":438,"phone":"619-574-1076","gmtOffset":-7,"name":"MISSION VALLEY CA","fullPostalCode":"92108-3212","region":"CA","hoursAmPm":"Sun: 11am-7pm; Mon: 10am-8pm; Tue: 10am-8pm; Wed: 10am-8pm; Thurs: 10am-8pm; Fri: 10am-8pm; Sat: 10am-8pm; Sun: 11am-7pm; Mon: 10am-8pm; Tue: 10am-8pm; Wed: 10am-8pm; Thurs: 10am-8pm; Fri: 10am-8pm; Sat: 10am-8pm; Sun: 11am-7pm; Mon: 10am-8pm; Tue: 10am-8pm; Wed: 10am-8pm; Thurs: 10am-8pm; Fri: 10am-8pm; Sat: 10am-8pm; Sun: 11am-7pm; Mon: 10am-8pm; Tue: 10am-8pm; Wed: 10am-8pm; Thurs: 10am-8pm; Fri: 10am-8pm; Sat: 10am-8pm","lat":32.76957,"longName":"Mission Valley"},{"country":"US","storeType":"PAC Standalone Store","hours":"Sun: Close; Mon: Close; Tue: 10-6; Wed: 10-6; Thurs: 10-6; Fri: 10-6; Sat: 10-6; Sun: Close; Mon: Close; Tue: 10-6; Wed: 10-6; Thurs: 10-6; Fri: 10-6; Sat: 10-6; Sun: Close; Mon: Close; Tue: 10-6; Wed: 10-6; Thurs: 10-6; Fri: 10-6; Sat: 10-6; Sun: Close; Mon: Close; Tue: 10-6; Wed: 10-6; Thurs: 10-6; Fri: 10-6; Sat: 10-6","address":"920 Morena Blvd","lng":-117.19917,"address2":"","city":"San Diego","postalCode":"92110","locationType":"Store","services":[],"storeId":1722,"phone":"619-681-4800","gmtOffset":-7,"name":"MISSION VALLEY","fullPostalCode":"92110-2611","region":"CA","hoursAmPm":"Sun: Close; Mon: Close; Tue: 10am-6pm; Wed: 10am-6pm; Thurs: 10am-6pm; Fri: 10am-6pm; Sat: 10am-6pm; Sun: Close; Mon: Close; Tue: 10am-6pm; Wed: 10am-6pm; Thurs: 10am-6pm; Fri: 10am-6pm; Sat: 10am-6pm; Sun: Close; Mon: Close; Tue: 10am-6pm; Wed: 10am-6pm; Thurs: 10am-6pm; Fri: 10am-6pm; Sat: 10am-6pm; Sun: Close; Mon: Close; Tue: 10am-6pm; Wed: 10am-6pm; Thurs: 10am-6pm; Fri: 10am-6pm; Sat: 10am-6pm","lat":32.76605,"longName":"Pacific Sales Mission Valley"},{"country":"US","storeType":"PAC Standalone Store","hours":"Sun: Close; Mon: Close; Tue: 10-6; Wed: 10-6; Thurs: 10-6; Fri: 10-6; Sat: 10-6; Sun: Close; Mon: Close; Tue: 10-6; Wed: 10-6; Thurs: 10-6; Fri: 10-6; Sat: 10-6; Sun: Close; Mon: Close; Tue: 10-6; Wed: 10-6; Thurs: 10-6; Fri: 10-6; Sat: 10-6; Sun: Close; Mon: Close; Tue: 10-6; Wed: 10-6; Thurs: 10-6; Fri: 10-6; Sat: 10-6","address":"7069 Consolidated Way","lng":-117.16322,"address2":"Ste 100","city":"San Diego","postalCode":"92121","locationType":"Store","services":[{"service":"Yardbird"}],"storeId":1718,"phone":"858-684-3660","gmtOffset":-7,"name":"LA JOLLA","fullPostalCode":"92121-2688","region":"CA","hoursAmPm":"Sun: Close; Mon: Close; Tue: 10am-6pm; Wed: 10am-6pm; Thurs: 10am-6pm; Fri: 10am-6pm; Sat: 10am-6pm; Sun: Close; Mon: Close; Tue: 10am-6pm; Wed: 10am-6pm; Thurs: 10am-6pm; Fri: 10am-6pm; Sat: 10am-6pm; Sun: Close; Mon: Close; Tue: 10am-6pm; Wed: 10am-6pm; Thurs: 10am-6pm; Fri: 10am-6pm; Sat: 10am-6pm; Sun: Close; Mon: Close; Tue: 10am-6pm; Wed: 10am-6pm; Thurs: 10am-6pm; Fri: 10am-6pm; Sat: 10am-6pm","lat":32.87792,"longName":"Pacific Sales La Jolla"},{"country":"US","storeType":"Big Box","hours":"Sun: 11-7; Mon: 11-8; Tue: 11-8; Wed: 11-8; Thurs: 11-8; Fri: 10-8; Sat: 10-8; Sun: 11-7; Mon: 11-8; Tue: 11-8; Wed: 11-8; Thurs: 11-8; Fri: 10-8; Sat: 10-8; Sun: 11-7; Mon: 11-8; Tue: 11-8; Wed: 11-8; Thurs: 11-8; Fri: 10-8; Sat: 10-8; Sun: 11-7; Mon: 11-8; Tue: 11-8; Wed: 11-8; Thurs: 11-8; Fri: 10-8; Sat: 10-8","address":"9540 Mira Mesa Blvd","lng":-117.11933,"address2":"","city":"San Diego","postalCode":"92126","locationType":"Store","services":[{"service":"Amazon Alexa Experience"},{"service":"Apple Authorized Service Provider"},{"service":"Apple Shop"},{"service":"Geek Squad Services"},{"service":"Google Home Experience"},{"service":"Car and GPS Install Services"},{"service":"Magnolia Home Theater"},{"service":"Microsoft Windows Store"},{"service":"Samsung Authorized Service Provider"},{"service":"Samsung Entertainment Experience"},{"service":"Trade-In"}],"storeId":352,"phone":"858-831-9003","gmtOffset":-7,"name":"MIRA MESA CA","fullPostalCode":"92126-4896","region":"CA","hoursAmPm":"Sun: 11am-7pm; Mon: 11am-8pm; Tue: 11am-8pm; Wed: 11am-8pm; Thurs: 11am-8pm; Fri: 10am-8pm; Sat: 10am-8pm; Sun: 11am-7pm; Mon: 11am-8pm; Tue: 11am-8pm; Wed: 11am-8pm; Thurs: 11am-8pm; Fri: 10am-8pm; Sat: 10am-8pm; Sun: 11am-7pm; Mon: 11am-8pm; Tue: 11am-8pm; Wed: 11am-8pm; Thurs: 11am-8pm; Fri: 10am-8pm; Sat: 10am-8pm; Sun: 11am-7pm; Mon: 11am-8pm; Tue: 11am-8pm; Wed: 11am-8pm; Thurs: 11am-8pm; Fri: 10am-8pm; Sat: 10am-8pm","lat":32.9178,"longName":"San Diego"},{"country":"US","storeType":"Big Box","hours":"Sun: 11-7; Mon: 11-7; Tue: 11-7; Wed: 11-7; Thurs: 11-7; Fri: 11-7; Sat: 11-7; Sun: 11-7; Mon: 11-7; Tue: 11-7; Wed: 11-7; Thurs: 11-7; Fri: 11-7; Sat: 11-7; Sun: 11-7; Mon: 11-7; Tue: 11-7; Wed: 11-7; Thurs: 11-7; Fri: 11-7; Sat: 11-7; Sun: 11-7; Mon: 11-7; Tue: 11-7; Wed: 11-7; Thurs: 11-7; Fri: 11-7; Sat: 11-7","address":"11160 Rancho Carmel Dr","lng":-117.08412,"address2":"","city":"San Diego","postalCode":"92128","locationType":"Store","services":[{"service":"Amazon Alexa Experience"},{"service":"Apple Authorized Service Provider"},{"service":"Geek Squad Services"},{"service":"Google Home Experience"},{"service":"Magnolia Home Theater"},{"service":"Trade-In"}],"storeId":1533,"phone":"858-613-7539","gmtOffset":-7,"name":"CARMEL MOUNTAIN CA","fullPostalCode":"92128-4672","region":"CA","hoursAmPm":"Sun: 11am-7pm; Mon: 11am-7pm; Tue: 11am-7pm; Wed: 11am-7pm; Thurs: 11am-7pm; Fri: 11am-7pm; Sat: 11am-7pm; Sun: 11am-7pm; Mon: 11am-7pm; Tue: 11am-7pm; Wed: 11am-7pm; Thurs: 11am-7pm; Fri: 11am-7pm; Sat: 11am-7pm; Sun: 11am-7pm; Mon: 11am-7pm; Tue: 11am-7pm; Wed: 11am-7pm; Thurs: 11am-7pm; Fri: 11am-7pm; Sat: 11am-7pm; Sun: 11am-7pm; Mon: 11am-7pm; Tue: 11am-7pm; Wed: 11am-7pm; Thurs: 11am-7pm; Fri: 11am-7pm; Sat: 11am-7pm","lat":32.97975,"longName":"Carmel Mountain"}]');
    }
    function locatePins(locations) {
      locations = JSON.parse(locations);
      let index = 1;
      let mapPins = new Array;
      let contentString;
      for (var location of locations) {
        if (location === locations[0]) {
          this.map = new google.maps.Map(document.getElementById("googleMap"), {
            zoom: 10,
            center: { lat: Number(location.lat), lng: Number(location.lng) },
          });
        }
        contentString = fillHTMLTemplate(location, index);
        mapPins.push(createMarker(location.lat, location.lng, index, contentString));
        index += 1;
      }

    }
    function createMarker(lattitude, longitude, index, contentString) {
      const infoWindow = new google.maps.InfoWindow({
        content: "",
        disableAutoPan: true,
      });
      var marker = new google.maps.Marker({
        position: { lat: lattitude, lng: longitude },
        map: this.map,
        zIndex: index,
      });
      google.maps.event.addListener(marker, 'click', function () {
        if (activeInfoWindow) { activeInfoWindow.close(); }
        closeBarOnKonyView();
        this.map.panTo(marker.getPosition());
        infoWindow.setContent(contentString);
        infoWindow.open({ anchor: marker, map: this.map, shouldFocus: true });
        activeInfoWindow = infoWindow;
      });
      infoWindow.addListener('closeclick', function () {
        closeBarOnKonyView();
      });
      return marker;
    }
    function fillHTMLTemplate(location, index) {
      var contentString =
        '<div id="LocationContent">' +
        '<div id="firstHeading" class="firstHeading">' +
        '<img src="compass.png" style="float:left"' +
        'width="50" height="50"><b>' + location.address + '</b>' +
        '</div>' +
        '<div id = contentDetails>' +
        '<p><b>Name: </b>' + location.name + '</p>' +
        '<p><b>City: </b>' + location.city + '</p>' +
        '</div>' +
        '<div class="buttonContainer">' +
        '<button type="button">More...</button>' +
        '</div>' +
        '</div>';
      return contentString;
    }
    function closeBarOnKonyView() {
      //alert("Function closeBarOnKonyView");
      //kony.evaluateJavaScriptInNativeContext('closeBarFromKonyView()');
    }
    function moreButtonClicked(index) {
      index = parseInt(index, 10);
      index -= 1;
      console.log(index);
      //kony.evaluateJavaScriptInNativeContext('retieveIndexLocationInKonyContext(' + index + ')')
    }
  </script>
  <script src="https://maps.googleapis.com/maps/api/js?sensor=false&callback=myMap"></script>
</body>

</html>
